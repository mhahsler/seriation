<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Michael Hahsler">

<title>A Comparison of Seriation Methods – R Package Seriation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-e8ed9d6b886f31797aaa4941d6e8f0a1.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="site_libs/datatables-binding-0.34.0/datatables.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="site_libs/dt-ext-fixedcolumns-1.13.6/css/fixedColumns.dataTables.min.css" rel="stylesheet">
<script src="site_libs/dt-ext-fixedcolumns-1.13.6/js/dataTables.fixedColumns.min.js"></script>
<link href="site_libs/crosstalk-1.2.2/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.2/js/crosstalk.min.js"></script>


</head>

<body class="nav-sidebar docked quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./seriation_methods.html">Methods and Criteria</a></li><li class="breadcrumb-item"><a href="./comparison.html">Comparison</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">R Package Seriation</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Package</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://github.com/mhahsler/seriation" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Package Overview</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Methods and Criteria</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./seriation_methods.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Methods</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./seriation_criteria.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Criteria</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./comparison.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Comparison</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Quick Guides</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://cran.r-project.org/web/packages/seriation/vignettes/seriation.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./heatmaps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How to reorder heatmaps</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./correlation_matrix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How to reorder correlation matrices</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./clustering.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How to evaluate clusters using dissimilarity plots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tpPL.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How to use Tree-Penalized Path Length Criterion with Package seriation</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#distance-seriation" id="toc-distance-seriation" class="nav-link" data-scroll-target="#distance-seriation">Distance seriation</a>
  <ul class="collapse">
  <li><a href="#comparison-between-methods" id="toc-comparison-between-methods" class="nav-link" data-scroll-target="#comparison-between-methods">Comparison between methods</a></li>
  <li><a href="#visualize-the-results" id="toc-visualize-the-results" class="nav-link" data-scroll-target="#visualize-the-results">Visualize the results</a></li>
  </ul></li>
  <li><a href="#matrix-seriation" id="toc-matrix-seriation" class="nav-link" data-scroll-target="#matrix-seriation">Matrix seriation</a>
  <ul class="collapse">
  <li><a href="#comparison-between-methods-1" id="toc-comparison-between-methods-1" class="nav-link" data-scroll-target="#comparison-between-methods-1">Comparison between methods</a></li>
  <li><a href="#visualize-the-results-1" id="toc-visualize-the-results-1" class="nav-link" data-scroll-target="#visualize-the-results-1">Visualize the results</a></li>
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"></a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./seriation_methods.html">Methods and Criteria</a></li><li class="breadcrumb-item"><a href="./comparison.html">Comparison</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">A Comparison of Seriation Methods</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Michael Hahsler </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>This document compares the seriation methods available in package <a href="https://github.com/mhahsler/seriation"><code>seriation</code></a> using the popular Iris data set and randomize the order of the objects.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"seriation"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"iris"</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(iris[<span class="fu">sample</span>(<span class="fu">nrow</span>(iris)), <span class="sc">-</span><span class="dv">5</span>])</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">dist</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="distance-seriation" class="level1">
<h1>Distance seriation</h1>
<p>We first register more seriation methods. Some of these methods require the installation of more packages.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">register_DendSer</span>()</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">register_optics</span>()</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">register_smacof</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The following methods will be used (a few slow methods are skipped).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>methods <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">list_seriation_methods</span>(<span class="st">"dist"</span>))</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># skip slow methods</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>methods <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(methods, <span class="fu">c</span>(<span class="st">"BBURCG"</span>, <span class="st">"BBWRCG"</span>, <span class="st">"Enumerate"</span>, <span class="st">"GSA"</span>))</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>methods </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "ARSA"           "DendSer"        "DendSer_ARc"    "DendSer_BAR"   
 [5] "DendSer_LPL"    "DendSer_PL"     "GW"             "GW_average"    
 [9] "GW_complete"    "GW_single"      "GW_ward"        "HC"            
[13] "HC_average"     "HC_complete"    "HC_single"      "HC_ward"       
[17] "Identity"       "isomap"         "isoMDS"         "MDS"           
[21] "MDS_angle"      "MDS_smacof"     "metaMDS"        "monoMDS"       
[25] "OLO"            "OLO_average"    "OLO_complete"   "OLO_single"    
[29] "OLO_ward"       "optics"         "QAP_2SUM"       "QAP_BAR"       
[33] "QAP_Inertia"    "QAP_LS"         "R2E"            "Random"        
[37] "Reverse"        "Sammon_mapping" "SGD"            "Spectral"      
[41] "Spectral_norm"  "SPIN_NH"        "SPIN_STS"       "TSP"           
[45] "VAT"           </code></pre>
</div>
</div>
<p>Details about the method can be found in the <a href="https://mhahsler.r-universe.dev/seriation/doc/manual.html#seriate">manual page for <code>seriate()</code></a>.</p>
<p>We use a loop to run the function <code>seriate()</code> with each method and calculate criterion measures which indicate how good the order is.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>orders <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>criterion <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (m <span class="cf">in</span> methods) {</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(m)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  tm <span class="ot">&lt;-</span> <span class="fu">system.time</span>(orders[[m]] <span class="ot">&lt;-</span> <span class="fu">seriate</span>(d, <span class="at">method =</span> m))</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  criterion[[m]] <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">time =</span> tm[<span class="dv">1</span>]<span class="sc">+</span>tm[<span class="dv">2</span>], <span class="fu">rbind</span>(<span class="fu">criterion</span>(d, orders[[m]]))) </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">" took"</span>, tm[<span class="dv">1</span>]<span class="sc">+</span>tm[<span class="dv">2</span>], <span class="st">"sec.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ARSA took 2.08 sec.
DendSer took 3.799 sec.
DendSer_ARc took 2.741 sec.
DendSer_BAR took 2.504 sec.
DendSer_LPL took 2.036 sec.
DendSer_PL took 1.612 sec.
GW took 0.204 sec.
GW_average took 0.205 sec.
GW_complete took 0.235 sec.
GW_single took 0.219 sec.
GW_ward took 0.215 sec.
HC took 0.229 sec.
HC_average took 0.236 sec.
HC_complete took 0.22 sec.
HC_single took 0.204 sec.
HC_ward took 0.206 sec.
Identity took 0.2 sec.
isomap</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 method overwritten by 'vegan':
  method         from 
  reorder.hclust gclus</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in e$value: partial match of 'value' to 'values'</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> took 0.378 sec.
isoMDS took 0.375 sec.
MDS took 0.235 sec.
MDS_angle took 0.243 sec.
MDS_smacof took 2.949 sec.
metaMDS took 2.008 sec.
monoMDS took 0.224 sec.
OLO took 0.197 sec.
OLO_average took 0.202 sec.
OLO_complete took 0.203 sec.
OLO_single took 0.2 sec.
OLO_ward took 0.203 sec.
optics took 0.211 sec.
QAP_2SUM took 0.243 sec.
QAP_BAR took 0.23 sec.
QAP_Inertia took 0.223 sec.
QAP_LS took 0.247 sec.
R2E took 0.284 sec.
Random took 0.293 sec.
Reverse took 0.22 sec.
Sammon_mapping took 0.571 sec.
SGD took 61.493 sec.
Spectral took 0.249 sec.
Spectral_norm took 0.561 sec.
SPIN_NH took 22.834 sec.
SPIN_STS took 40.876 sec.
TSP took 0.222 sec.
VAT took 0.219 sec.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>criterion <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, criterion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We align the seriation orders. The reason is that an order 1, 2, 3 and 3, 2, 1 are equivalent and just an artifact of the algorithm. Aligning will reverse some orders so they are better aligned. Then we sort the orders from best to worst according to a popular seriation criterion measure called <code>Gradient_weighted</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>orders <span class="ot">&lt;-</span> <span class="fu">ser_align</span>(orders)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>best_to_worse <span class="ot">&lt;-</span> <span class="fu">order</span>(criterion[[<span class="st">"Gradient_weighted"</span>]], <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>orders <span class="ot">&lt;-</span> orders[best_to_worse]</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>criterion <span class="ot">&lt;-</span> criterion[best_to_worse, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="comparison-between-methods" class="level2">
<h2 class="anchored" data-anchor-id="comparison-between-methods">Comparison between methods</h2>
<p>We can compare the seriation methods by how similar the orders are that they produce (measured using Spearman). The following code calculates distances between orders and then performs hierarchical clustering.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>dst <span class="ot">&lt;-</span> <span class="fu">ser_dist</span>(orders) </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>hc <span class="ot">&lt;-</span> <span class="fu">permute</span>(<span class="fu">hclust</span>(dst), <span class="at">order =</span> <span class="st">"OLO"</span>, <span class="at">dist =</span> dst)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="comparison_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>The reordered dendrogram clearly shows a group of methods based on hierarchical clustering focused on path length and another group that tries to optimize the other seriation measures.</p>
<p>Here is a table to compare the seriation methods on different criterion measures. Use the interactive table to sort the methods given different measures. Note that some are maximized and some should be minimized. Details about the measures can be found in the <a href="https://mhahsler.r-universe.dev/seriation/doc/manual.html#criterion">manual page for <code>criterion()</code></a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(<span class="fu">round</span>(criterion, <span class="dv">2</span>), <span class="at">extensions =</span> <span class="st">"FixedColumns"</span>,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">options =</span> <span class="fu">list</span>(<span class="at">paging =</span> <span class="cn">TRUE</span>, <span class="at">searching =</span> <span class="cn">TRUE</span>, <span class="at">info =</span> <span class="cn">FALSE</span>,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">sort =</span> <span class="cn">TRUE</span>, <span class="at">scrollX =</span> <span class="cn">TRUE</span>, <span class="at">fixedColumns =</span> <span class="fu">list</span>(<span class="at">leftColumns =</span> <span class="dv">1</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">formatRound</span>(<span class="at">columns =</span> <span class="fu">colnames</span>(criterion) , <span class="at">mark =</span> <span class="st">""</span>, <span class="at">digits=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-34923190bb4c3f88665e" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-34923190bb4c3f88665e">{"x":{"filter":"none","vertical":false,"extensions":["FixedColumns"],"data":[["ARSA","QAP_LS","metaMDS","MDS_smacof","QAP_Inertia","SGD","Spectral","Sammon_mapping","QAP_2SUM","isoMDS","MDS","SPIN_STS","DendSer_ARc","DendSer","DendSer_BAR","isomap","SPIN_NH","DendSer_LPL","HC","HC_complete","DendSer_PL","OLO_average","OLO","OLO_complete","GW","GW_complete","GW_ward","OLO_ward","GW_average","OLO_single","GW_single","Spectral_norm","MDS_angle","VAT","TSP","HC_single","QAP_BAR","optics","HC_ward","HC_average","R2E","monoMDS","Random","Identity","Reverse"],[2.08,0.25,2.01,2.95,0.22,61.49,0.25,0.57,0.24,0.38,0.23,40.88,2.74,3.8,2.5,0.38,22.83,2.04,0.23,0.22,1.61,0.2,0.2,0.2,0.2,0.23,0.22,0.2,0.21,0.2,0.22,0.5600000000000001,0.24,0.22,0.22,0.2,0.23,0.21,0.21,0.24,0.28,0.22,0.29,0.2,0.22],[17811232.65,17810755.38,17812025.88,17812731.39,17817657.1,17817836.68,17821593.29,17803289.91,17800757.59,17831638.49,17831638.49,17848375.01,17876078.28,17887028.78,17887028.78,17885505.49,18053307.95,18132149.91,18258645.98,18258645.98,18200736.77,18269341.73,18292979.96,18292979.96,18310214.4,18310214.4,18438376.45,18410342.17,18538550.4,18474658.72,18534766.36,18699746.46,19264911.14,19314451.14,20749361.36,19984839.48,21623400.79,21616806.71,21708968.77,21843526.12,22155912.17,28073412.13,30005679.5,30337180.24,30337180.24],[9438.610000000001,9434.27,9504.209999999999,9471.18,9730.690000000001,9715.360000000001,9887.389999999999,9704.719999999999,9761.99,10451.48,10451.48,13056.04,13412.91,14008.74,14008.74,15169.57,30198.85,34855.8,38506.79,38506.79,38781.43,43484.13,45325.49,45325.49,44912.7,44912.7,50803.07,51902.86,53133.11,56895.87,62098.9,79141.36,108327.34,130231.55,195024.75,194598.53,266029.77,300861.92,317349.46,329517.05,339680.8,644304.92,945177.0699999999,961001.7,961001.7],[54823,54796,54604,55069,54457,54263,54924,61996,62407,58810,58810,73417,76417,80168,80168,80864,127121,145985,135978,135978,152987,162486,168500,168500,173106,173106,177765,179586,184188,167686,179034,166378,221616,218125,302845,267868,314199,371103,368777,387687,397967,411062,550572,556061,556061],[2243448.63,2243449.16,2243469.42,2243518.16,2243598.06,2243614.34,2243682.33,2244220,2244248.01,2244348.59,2244348.59,2247333.94,2247775.23,2248403.43,2248403.43,2249203.1,2264983.6,2269554.69,2271785.63,2271785.63,2273198.8,2277556.24,2279320.21,2279320.21,2279352.61,2279352.61,2284195.87,2285630.63,2286007.45,2288173.98,2293745.77,2306285.9,2332072.92,2350989.37,2406778.38,2410190.22,2472538.73,2515313.45,2525770.37,2541537.59,2556039.9,2649234.71,2831956.09,2842806.59,2842806.59],[56363,56359.08,56418.65,56310.21,56552.12,56499.08,56609.97,55760.07,55830.1,56588.08,56588.08,56763.76,56474.23,56159.74,56159.74,56666.77,55710.51,57077.85,61865.63,61865.63,58537.24,58055.28,58416.81,58416.81,59279.73,59279.73,60120.37,60393.42,64333.94,62276.93,62255.92,65816.92999999999,63869.44,73359.8,65238.63,79885.03999999999,64421.41,79231.24000000001,81386.12,80325.98,74532.39,109133.79,163128.31,165478.17,165478.17],[992260,992314,992695,991764,992994,993381,992058,977903,977084,984277,984277,955062,949063,941567,941567,940173,847655,809923,829940,829940,795908,776925,764888,764888,755679,755679,746340,742715,733490,766527,743823,769117,658672,665606,496197,566122,473476,359685,364282,326460,305960,279917,922,-10076,-10076],[1772128.25,1772126.66,1772065.89,1771919.66,1771679.97,1771631.13,1771427.16,1769814.16,1769730.1,1769428.38,1769428.38,1760472.32,1759148.46,1757263.85,1757263.85,1754864.85,1707523.34,1693810.08,1687117.25,1687117.25,1682877.73,1669805.42,1664513.52,1664513.52,1664416.32,1664416.32,1649886.55,1645582.24,1644451.78,1637952.2,1621236.84,1583616.45,1506255.38,1449506.04,1282139.01,1271903.49,1084857.97,956533.79,925163.02,877861.37,834354.4399999999,554770.03,6605.88,-25945.61,-25945.61],[356949760.46,356949703.13,356960077.43,356954170.3,356976622.12,356955399.75,356910342.64,356624718.43,356637465.82,356821108.54,356821108.54,355944624.06,355838234.97,355580212.39,355580212.39,354956626.48,349614249.26,348669728.35,350360122.87,350360122.87,347794787.52,346780581.73,346350972.72,346350972.72,346562075.61,346562075.61,345378074.17,345352261.17,346815925.81,345732687.19,343660139.48,339396179.61,329715037.11,331583884.79,306869320.16,315771389.89,286134170.59,278340312.67,280865507.89,272021561.85,262816237.29,249031676.27,214347120.77,212025030.65,212025030.65],[6412.07,6549.83,6639.98,6526.57,7005.78,6841.04,6987.1,6477.68,6071.84,7155.17,7155.17,7082.55,4775.3,4164.57,4164.57,6502.89,4969.28,3651.85,5092.25,5092.25,3690.78,3671.38,4101.96,4101.96,4521.2,4521.2,3797.78,3563.63,3916.32,4796.97,4986.49,9607.76,5877.18,5539.38,3718.75,7405.08,5572.68,6578.76,5178.99,5227.33,6594.65,11907.43,25612.43,31180.65,27012.25],[76487634.69,76487636.79000001,76487717.81999999,76487912.8,76488232.38,76488297.5,76488569.45999999,76490720.14,76490832.20999999,76491234.5,76491234.5,76503175.92,76504941.06,76507453.89,76507453.89,76510652.55,76573774.56,76592058.91,76600982.68000001,76600982.68000001,76606635.37,76624065.13,76631120.98999999,76631120.98999999,76631250.58,76631250.58,76650623.61,76656362.69,76657869.97,76666536.08,76688823.23,76738983.75,76842131.84999999,76917797.63,77140953.67,77154601.03,77403995.06,77575093.95999999,77616921.65000001,77679990.52,77737999.76000001,78110778.98,78841664.5,78885066.5,78885066.5],[4044013.25,4044012.19,4043971.68,4043874.19,4043714.4,4043681.84,4043545.86,4042470.52,4042414.49,4042213.34,4042213.34,4036242.63,4035360.06,4034103.65,4034103.65,4032504.31,4000943.31,3991801.13,3987339.25,3987339.25,3984512.91,3975798.03,3972270.1,3972270.1,3972205.3,3972205.3,3962518.78,3959649.25,3958895.6,3954562.55,3943418.97,3918338.71,3866764.67,3828931.77,3717353.75,3710530.08,3585833.06,3500283.61,3479369.77,3447835.33,3418830.71,3232441.1,2866998.34,2845297.34,2845297.34],[0.1,0.1,0.23,0.1,0.23,0.23,0.18,0.11,0.23,0.1,0.1,0.24,0.24,0.24,0.24,0.24,0.27,0.28,0.28,0.28,0.28,0.29,0.29,0.29,0.29,0.29,0.3,0.31,0.31,0.31,0.32,0.3,0.37,0.39,0.46,0.46,0.52,0.5600000000000001,0.57,0.58,0.59,0.67,0.79,0.79,0.79],[7268.32,7267.81,7258.79,7274.23,7257.02,7257.6,7253.71,7292.59,7282.85,7250.23,7250.23,7270.45,7325.61,7326.96,7326.96,7270.79,7300.56,7335.24,7288.9,7288.9,7326.29,7331.86,7337.56,7337.56,7329.35,7329.35,7324.41,7337.49,7325.75,7312.76,7309.68,7157.91,7165.3,7267.96,7316.53,7244.39,7309.85,7235.71,7259.26,7279.81,7250.03,7063.44,5995.76,5840.71,5840.71],[1039.11,1040.59,1083,981.9400000000001,1097.98,1092.15,1111.65,854.15,889.54,1167.73,1167.73,995.37,631.79,618.53,618.53,1010.79,737.38,523.72,918.39,918.39,532.8099999999999,519.9,501.42,501.42,595.6,595.6,605.97,506.27,629.45,779.05,772.83,1836.38,1945.32,1235.85,558.76,1372.39,685.63,1410.52,1069.82,1008.2,1143.09,2995.83,11293.28,11991.9,11991.9],[480.34,482.39,518.48,456.71,519.46,523.23,538.78,396.54,422.23,552.6799999999999,552.6799999999999,471.83,264.48,259.07,259.07,479.84,335.14,215.2,363.08,363.08,218.76,213.03,205.91,205.91,244.01,244.01,244.43,206.2,255.44,313.6,317.45,822.24,855.6799999999999,495.06,225.49,554.83,304.54,578.0599999999999,420.3,396.77,514.8200000000001,1299.87,5473.6,6100.87,6100.87],[86.14,86.75,89.34,85.18000000000001,89.3,90.12,91.29000000000001,81.31999999999999,84.52,91.92,91.92,87.81,60.24,59.2,59.2,86.69,73.73,52.34,64.48999999999999,64.48999999999999,52.97,52.02,51.31,51.31,56.37,56.37,54.28,50.55,56.9,63.75,66.55,114.98,106.57,83.45999999999999,51.64,90.5,68.95999999999999,94.06999999999999,71.08,70.48999999999999,91.3,154.73,353.89,387.95,387.95],[0.05,0.05,0.05,0.05,0.05,0.05,0.05,0.06,0.06,0.05,0.05,0.07000000000000001,0.07000000000000001,0.07000000000000001,0.07000000000000001,0.07000000000000001,0.12,0.13,0.12,0.12,0.14,0.15,0.15,0.15,0.16,0.16,0.16,0.16,0.17,0.15,0.16,0.15,0.2,0.2,0.27,0.24,0.28,0.34,0.33,0.35,0.36,0.37,0.5,0.5,0.5],[0.91,0.91,0.91,0.91,0.91,0.91,0.91,0.91,0.91,0.91,0.91,0.9,0.9,0.9,0.9,0.9,0.89,0.88,0.86,0.86,0.88,0.87,0.86,0.86,0.86,0.86,0.85,0.85,0.83,0.84,0.84,0.83,0.8,0.76,0.71,0.6899999999999999,0.65,0.59,0.55,0.55,0.57,0.32,0.01,0.01,0.01],[0.1,0.1,0.23,0.1,0.23,0.23,0.18,0.11,0.23,0.1,0.1,0.24,0.24,0.24,0.24,0.24,0.27,0.28,0.28,0.28,0.28,0.29,0.29,0.29,0.29,0.29,0.3,0.3,0.3,0.31,0.31,0.3,0.04,0.39,0.45,0.45,0.5,0.54,0.55,0.5600000000000001,0.57,0.63,0.72,0.73,0.73]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>time<\/th>\n      <th>X2SUM<\/th>\n      <th>AR_deviations<\/th>\n      <th>AR_events<\/th>\n      <th>ARc<\/th>\n      <th>BAR<\/th>\n      <th>Gradient_raw<\/th>\n      <th>Gradient_weighted<\/th>\n      <th>Inertia<\/th>\n      <th>Lazy_path_length<\/th>\n      <th>Least_squares<\/th>\n      <th>LS<\/th>\n      <th>MDS_stress<\/th>\n      <th>ME<\/th>\n      <th>Moore_stress<\/th>\n      <th>Neumann_stress<\/th>\n      <th>Path_length<\/th>\n      <th>RGAR<\/th>\n      <th>Rho<\/th>\n      <th>smacof_stress0<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"paging":true,"searching":true,"info":false,"sort":true,"scrollX":true,"fixedColumns":{"leftColumns":1},"columnDefs":[{"targets":1,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \"\", \".\", null);\n  }"},{"targets":2,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \"\", \".\", null);\n  }"},{"targets":3,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \"\", \".\", null);\n  }"},{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \"\", \".\", null);\n  }"},{"targets":5,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \"\", \".\", null);\n  }"},{"targets":6,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \"\", \".\", null);\n  }"},{"targets":7,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \"\", \".\", null);\n  }"},{"targets":8,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \"\", \".\", null);\n  }"},{"targets":9,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \"\", \".\", null);\n  }"},{"targets":10,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \"\", \".\", null);\n  }"},{"targets":11,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \"\", \".\", null);\n  }"},{"targets":12,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \"\", \".\", null);\n  }"},{"targets":13,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \"\", \".\", null);\n  }"},{"targets":14,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \"\", \".\", null);\n  }"},{"targets":15,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \"\", \".\", null);\n  }"},{"targets":16,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \"\", \".\", null);\n  }"},{"targets":17,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \"\", \".\", null);\n  }"},{"targets":18,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \"\", \".\", null);\n  }"},{"targets":19,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \"\", \".\", null);\n  }"},{"targets":20,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \"\", \".\", null);\n  }"},{"className":"dt-right","targets":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"time","targets":1},{"name":"X2SUM","targets":2},{"name":"AR_deviations","targets":3},{"name":"AR_events","targets":4},{"name":"ARc","targets":5},{"name":"BAR","targets":6},{"name":"Gradient_raw","targets":7},{"name":"Gradient_weighted","targets":8},{"name":"Inertia","targets":9},{"name":"Lazy_path_length","targets":10},{"name":"Least_squares","targets":11},{"name":"LS","targets":12},{"name":"MDS_stress","targets":13},{"name":"ME","targets":14},{"name":"Moore_stress","targets":15},{"name":"Neumann_stress","targets":16},{"name":"Path_length","targets":17},{"name":"RGAR","targets":18},{"name":"Rho","targets":19},{"name":"smacof_stress0","targets":20}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render","options.columnDefs.4.render","options.columnDefs.5.render","options.columnDefs.6.render","options.columnDefs.7.render","options.columnDefs.8.render","options.columnDefs.9.render","options.columnDefs.10.render","options.columnDefs.11.render","options.columnDefs.12.render","options.columnDefs.13.render","options.columnDefs.14.render","options.columnDefs.15.render","options.columnDefs.16.render","options.columnDefs.17.render","options.columnDefs.18.render","options.columnDefs.19.render"],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="visualize-the-results" class="level2">
<h2 class="anchored" data-anchor-id="visualize-the-results">Visualize the results</h2>
<p>Plot the reordered dissimilarity matrices. Dark blocks along the main diagonal mean that the order reveals a “cluster” of similar objects. The Iris dataset contains three species, but two of them are very similar, so we expect to see one smaller block and one larger block.</p>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> <span class="fu">names</span>(orders))</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pimage</span>(d, orders[[n]], <span class="at">main =</span> n , <span class="at">key =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="comparison_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="comparison_files/figure-html/unnamed-chunk-8-2.png" class="img-fluid"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="comparison_files/figure-html/unnamed-chunk-8-3.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="comparison_files/figure-html/unnamed-chunk-8-4.png" class="img-fluid"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="comparison_files/figure-html/unnamed-chunk-8-5.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="comparison_files/figure-html/unnamed-chunk-8-6.png" class="img-fluid"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="comparison_files/figure-html/unnamed-chunk-8-7.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="comparison_files/figure-html/unnamed-chunk-8-8.png" class="img-fluid"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="comparison_files/figure-html/unnamed-chunk-8-9.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="comparison_files/figure-html/unnamed-chunk-8-10.png" class="img-fluid"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="comparison_files/figure-html/unnamed-chunk-8-11.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="comparison_files/figure-html/unnamed-chunk-8-12.png" class="img-fluid"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="comparison_files/figure-html/unnamed-chunk-8-13.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="comparison_files/figure-html/unnamed-chunk-8-14.png" class="img-fluid"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="comparison_files/figure-html/unnamed-chunk-8-15.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="comparison_files/figure-html/unnamed-chunk-8-16.png" class="img-fluid"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="comparison_files/figure-html/unnamed-chunk-8-17.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="comparison_files/figure-html/unnamed-chunk-8-18.png" class="img-fluid"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="comparison_files/figure-html/unnamed-chunk-8-19.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="comparison_files/figure-html/unnamed-chunk-8-20.png" class="img-fluid"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="comparison_files/figure-html/unnamed-chunk-8-21.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="comparison_files/figure-html/unnamed-chunk-8-22.png" class="img-fluid"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="comparison_files/figure-html/unnamed-chunk-8-23.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="comparison_files/figure-html/unnamed-chunk-8-24.png" class="img-fluid"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="comparison_files/figure-html/unnamed-chunk-8-25.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="comparison_files/figure-html/unnamed-chunk-8-26.png" class="img-fluid"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="comparison_files/figure-html/unnamed-chunk-8-27.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="comparison_files/figure-html/unnamed-chunk-8-28.png" class="img-fluid"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="comparison_files/figure-html/unnamed-chunk-8-29.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="comparison_files/figure-html/unnamed-chunk-8-30.png" class="img-fluid"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="comparison_files/figure-html/unnamed-chunk-8-31.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="comparison_files/figure-html/unnamed-chunk-8-32.png" class="img-fluid"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="comparison_files/figure-html/unnamed-chunk-8-33.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="comparison_files/figure-html/unnamed-chunk-8-34.png" class="img-fluid"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="comparison_files/figure-html/unnamed-chunk-8-35.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="comparison_files/figure-html/unnamed-chunk-8-36.png" class="img-fluid"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="comparison_files/figure-html/unnamed-chunk-8-37.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="comparison_files/figure-html/unnamed-chunk-8-38.png" class="img-fluid"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="comparison_files/figure-html/unnamed-chunk-8-39.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="comparison_files/figure-html/unnamed-chunk-8-40.png" class="img-fluid"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="comparison_files/figure-html/unnamed-chunk-8-41.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="comparison_files/figure-html/unnamed-chunk-8-42.png" class="img-fluid"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="comparison_files/figure-html/unnamed-chunk-8-43.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="comparison_files/figure-html/unnamed-chunk-8-44.png" class="img-fluid"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="comparison_files/figure-html/unnamed-chunk-8-45.png" class="img-fluid"></p>
</div>
</div>
</div>
</section>
</section>
<section id="matrix-seriation" class="level1">
<h1>Matrix seriation</h1>
<p>Matrix seriation reorders rows and columns of a data matrix. We perform the same steps as for distances in the previous section.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>methods <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">list_seriation_methods</span>(<span class="st">"matrix"</span>))</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># AOE if for correlation matrices only</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>methods <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(methods, <span class="fu">c</span>(<span class="st">"AOE"</span>))</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>methods </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "BEA"              "BEA_TSP"          "BK_unconstrained" "CA"              
 [5] "Heatmap"          "Identity"         "LLE"              "Mean"            
 [9] "PCA"              "PCA_angle"        "Random"           "Reverse"         </code></pre>
</div>
</div>
<p>Performing seriation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>orders <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>criterion <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (m <span class="cf">in</span> methods) {</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(m)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  tm <span class="ot">&lt;-</span> <span class="fu">system.time</span>(orders[[m]] <span class="ot">&lt;-</span> <span class="fu">seriate</span>(x, <span class="at">method =</span> m))</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  criterion[[m]] <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">time =</span> tm[<span class="dv">1</span>]<span class="sc">+</span>tm[<span class="dv">2</span>], <span class="fu">rbind</span>(<span class="fu">criterion</span>(x, orders[[m]])))</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">" took"</span>, tm[<span class="dv">1</span>]<span class="sc">+</span>tm[<span class="dv">2</span>], <span class="st">"sec.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>BEA took 0.562 sec.
BEA_TSP took 0.511 sec.
BK_unconstrained took 0.171 sec.
CA took 0.167 sec.
Heatmap took 0.55 sec.
Identity took 0.17 sec.
LLE took 0.454 sec.
Mean took 0.167 sec.
PCA took 0.168 sec.
PCA_angle</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in prcomp.default(x, center = center, scale. = scale, rank = 2L):
partial argument match of 'rank' to 'rank.'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in prcomp.default(t(x), center = center, scale. = scale, rank = 2L):
partial argument match of 'rank' to 'rank.'</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> took 0.173 sec.
Random took 0.167 sec.
Reverse took 0.172 sec.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>criterion <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, criterion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="comparison-between-methods-1" class="level2">
<h2 class="anchored" data-anchor-id="comparison-between-methods-1">Comparison between methods</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(<span class="fu">round</span>(criterion, <span class="dv">2</span>), <span class="at">extensions =</span> <span class="st">"FixedColumns"</span>,</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">options =</span> <span class="fu">list</span>(<span class="at">paging =</span> <span class="cn">TRUE</span>, <span class="at">searching =</span> <span class="cn">TRUE</span>, <span class="at">info =</span> <span class="cn">FALSE</span>,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">sort =</span> <span class="cn">TRUE</span>, <span class="at">scrollX =</span> <span class="cn">TRUE</span>, <span class="at">fixedColumns =</span> <span class="fu">list</span>(<span class="at">leftColumns =</span> <span class="dv">1</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">formatRound</span>(<span class="at">columns =</span> <span class="fu">colnames</span>(criterion) , <span class="at">mark =</span> <span class="st">""</span>, <span class="at">digits =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-f38a5bc4fc491406eae1" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-f38a5bc4fc491406eae1">{"x":{"filter":"none","vertical":false,"extensions":["FixedColumns"],"data":[["BEA","BEA_TSP","BK_unconstrained","CA","Heatmap","Identity","LLE","Mean","PCA","PCA_angle","Random","Reverse"],[0.5600000000000001,0.51,0.17,0.17,0.55,0.17,0.45,0.17,0.17,0.17,0.17,0.17],[-0.13,-0.09,-0.02,0.22,-0.04,0.02,-0.05,-0.05,0.05,0.04,0.01,0.02],[16518.78,16523.67,13449.6,16401.6,15130.22,13995.28,15111.45,15113.91,15120.47,14291.68,13987.46,13995.28],[19779.18,19781.78,39272.88,20347.34,12980.92,22559.76,13074.14,13006.9,13052.16,16317.26,33019.8,22559.76],[6661.68,6642.12,14285.32,6934.24,4395.22,9043.780000000001,4486.04,4504.76,4484.76,5564,12181.06,9043.780000000001]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>time<\/th>\n      <th>Cor_R<\/th>\n      <th>ME<\/th>\n      <th>Moore_stress<\/th>\n      <th>Neumann_stress<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"paging":true,"searching":true,"info":false,"sort":true,"scrollX":true,"fixedColumns":{"leftColumns":1},"columnDefs":[{"targets":1,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \"\", \".\", null);\n  }"},{"targets":2,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \"\", \".\", null);\n  }"},{"targets":3,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \"\", \".\", null);\n  }"},{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \"\", \".\", null);\n  }"},{"targets":5,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \"\", \".\", null);\n  }"},{"className":"dt-right","targets":[1,2,3,4,5]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"time","targets":1},{"name":"Cor_R","targets":2},{"name":"ME","targets":3},{"name":"Moore_stress","targets":4},{"name":"Neumann_stress","targets":5}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render","options.columnDefs.4.render"],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="visualize-the-results-1" class="level2">
<h2 class="anchored" data-anchor-id="visualize-the-results-1">Visualize the results</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>best_to_worse <span class="ot">&lt;-</span> <span class="fu">order</span>(criterion[[<span class="st">"Moore_stress"</span>]], <span class="at">decreasing =</span> <span class="cn">FALSE</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>orders <span class="ot">&lt;-</span> orders[best_to_worse]</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>criterion <span class="ot">&lt;-</span> criterion[best_to_worse, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> <span class="fu">names</span>(orders))</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pimage</span>(x, orders[[n]], <span class="at">main =</span> n , <span class="at">key =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="comparison_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="comparison_files/figure-html/unnamed-chunk-13-2.png" class="img-fluid"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="comparison_files/figure-html/unnamed-chunk-13-3.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="comparison_files/figure-html/unnamed-chunk-13-4.png" class="img-fluid"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="comparison_files/figure-html/unnamed-chunk-13-5.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="comparison_files/figure-html/unnamed-chunk-13-6.png" class="img-fluid"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="comparison_files/figure-html/unnamed-chunk-13-7.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="comparison_files/figure-html/unnamed-chunk-13-8.png" class="img-fluid"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="comparison_files/figure-html/unnamed-chunk-13-9.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="comparison_files/figure-html/unnamed-chunk-13-10.png" class="img-fluid"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="comparison_files/figure-html/unnamed-chunk-13-11.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="comparison_files/figure-html/unnamed-chunk-13-12.png" class="img-fluid"></p>
</div>
</div>
</div>
</section>
<section id="section" class="level2">
<h2 class="anchored" data-anchor-id="section"></h2>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>